"use strict";(self.webpackChunklinux_tutorial=self.webpackChunklinux_tutorial||[]).push([["4515"],{7993:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>d,toc:()=>a,default:()=>u,metadata:()=>s,assets:()=>c,contentTitle:()=>o});var s=JSON.parse('{"id":"module","title":"Modules","description":"Create module files to set environment variables for various compilers and","source":"@site/docs/module.mdx","sourceDirName":".","slug":"/module","permalink":"/linux/module","draft":false,"unlisted":false,"editUrl":"https://github.com/pranabdas/linux/blob/main/docs/module.mdx","tags":[],"version":"current","frontMatter":{"title":"Modules"},"sidebar":"docs","previous":{"title":"HPC","permalink":"/linux/hpc"},"next":{"title":"Homebrew","permalink":"/linux/brew"}}'),t=r(4848),l=r(4429),i=r(4565);let d={title:"Modules"},o=void 0,c={},a=[{value:"Resources",id:"resources",level:2}];function h(e){let n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Create module files to set environment variables for various compilers and\nlibraries."}),"\n",(0,t.jsx)(n.p,{children:"Install Environment modules in Debian/Ubuntu:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install --no-install-recommends environment-modules\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"source"})," following script so that ",(0,t.jsx)(n.code,{children:"module"})," command is available. You may include\nin your ",(0,t.jsx)(n.code,{children:".bashrc"})," as well."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source /etc/profile.d/modules.sh\n"})}),"\n",(0,t.jsx)(n.p,{children:"Here we will try to create a module for GCC. Download GCC source code and build:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"wget https://mirror.freedif.org/GNU/gcc/gcc-12.3.0/gcc-12.3.0.tar.gz\ntar zxf gcc-12.3.0.tar.gz\ncd gcc-12.3.0\n./contrib/download_prerequisites\ncd ..\nmkdir objdir\ncd objdir\n${PWD}/../gcc-12.3.0/configure --prefix=/workspaces/compilers/gcc-12.3.0 --enable-languages=c,c++,fortran,go --disable-multilib\nmake -j16  # time consuming task, parallelize on large number of processors\nmake install\n\ncd ..\nrm gcc-12.3.0.tar.gz\nrm -rf gcc-12.3.0\nrm -rf objdir\n"})}),"\n",(0,t.jsx)(n.p,{children:"Here is our modulefile:"}),"\n","\n",(0,t.jsx)(i.A,{language:"bash",title:"hpc/modulefiles/gcc-12.3.0",showLineNumbers:!0,children:'#%Module 1.0\n## module gcc-12.3.0\n## /workspaces/linux/src/modulefiles/gcc-12.3.0\n## Author: Pranab Das\n\nproc ModulesHelp { } {\n  global version modroot\n  puts stderr "gcc-12.3.0 - sets the Environment for gcc-12.3.0"\n}\n\nmodule-whatis "Sets the Environment for gcc-12.3.0"\n\nset             topdir          /workspaces/compilers/gcc-12.3.0\nset             version         12.3.0\n\nsetenv          CC              ${topdir}/bin/gcc\nsetenv          GCC             ${topdir}/bin/gcc\nsetenv          FC              ${topdir}/bin/gfortran\nsetenv          F77             ${topdir}/bin/gfortran\nsetenv          F90             ${topdir}/bin/gfortran\n\nprepend-path    PATH            ${topdir}/include\nprepend-path    PATH            ${topdir}/bin\nprepend-path    MANPATH         ${topdir}/man\nprepend-path    LD_LIBRARY_PATH ${topdir}/lib\n'}),"\n",(0,t.jsxs)(n.p,{children:["We will store our module files under ",(0,t.jsx)(n.code,{children:"/workspaces/linux/hpc/modulefiles"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"export MODULEPATH=${MODULEPATH}:/workspaces/linux/hpc/modulefiles\n"})}),"\n",(0,t.jsx)(n.p,{children:"Now we can test our module:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gcc --version\nmodule --help\nmodule avail\nmodule load gcc-12.3.0  # module add gcc-12.3.0\ngcc --version\nmodule list\nmodule purge  # module remove gcc-12.3.0\ngcc --version\n"})}),"\n",(0,t.jsx)(n.p,{children:"Useful commands to use in module file:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Command"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"setenv"}),(0,t.jsx)(n.td,{children:"set the specified environment variable to the supplied value."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"unsetenv"}),(0,t.jsx)(n.td,{children:"unset the specified environment variable. If an argument is supplied, then, while unloading the module, the variable will be re-set, to that argument."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"append-path"}),(0,t.jsx)(n.td,{children:"put the supplied argument on the end of the specified variable. The variable should be a list of colon-separated entries. PATH is one such variable."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"prepend-path"}),(0,t.jsx)(n.td,{children:"put the supplied argument at the start of the specified variable."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"remove-path"}),(0,t.jsx)(n.td,{children:"remove the supplied argument from the specified variable, wherever along its length it might be."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"prereq"}),(0,t.jsx)(n.td,{children:'insist that the specified module be loaded before loading the current module. (Note: Usually, it\'s easier to just put a "module load" in to get the dependency.)'})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"conflict"}),(0,t.jsx)(n.td,{children:"insist that the specified module not be loaded."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"module load"}),(0,t.jsx)(n.td,{children:"load the specified module."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"module-whatis"}),(0,t.jsx)(n.td,{children:'follow with a help string, to be printed whenever the user issues the "module whatis" command on this module. It should briefly describe the software loaded by this module.'})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.prl.res.in/prl-eng/hpc/getting_started/creating_custom_modules",children:"https://www.prl.res.in/prl-eng/hpc/getting_started/creating_custom_modules"})}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);