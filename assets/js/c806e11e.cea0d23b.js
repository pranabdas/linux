"use strict";(self.webpackChunklinux_tutorial=self.webpackChunklinux_tutorial||[]).push([[344],{1194:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var a=s(4848),t=s(8453);const r={title:"Storage Management",keywords:["linux","swap"]},i=void 0,o={id:"storage-management",title:"Storage Management",description:"Swap memory",source:"@site/docs/storage-management.md",sourceDirName:".",slug:"/storage-management",permalink:"/linux/storage-management",draft:!1,unlisted:!1,editUrl:"https://github.com/pranabdas/linux/blob/main/docs/storage-management.md",tags:[],version:"current",frontMatter:{title:"Storage Management",keywords:["linux","swap"]},sidebar:"docs",previous:{title:"TLS Key management",permalink:"/linux/tls-key-management"},next:{title:"Apache",permalink:"/linux/apache"}},l={},c=[{value:"Swap memory",id:"swap-memory",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"swap-memory",children:"Swap memory"}),"\n",(0,a.jsx)(n.p,{children:"Instructions on how to create swap space in RHEL/Fedora systems."}),"\n",(0,a.jsx)(n.p,{children:"Check swap memory status by using one or more of the following commands:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"swapon -s\ncat /proc/swaps\nfree -h\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example output in a system where there was no swap memory set:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"[root@almalinux ~]# free -h\n               total        used        free      shared  buff/cache   available\nMem:           7.7Gi       417Mi       7.3Gi        16Mi       227Mi       7.3Gi\nSwap:             0B          0B          0B\n"})}),"\n",(0,a.jsx)(n.p,{children:"Create an empty file of size 4GB for swap:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dd if=/dev/zero of=/swapfile bs=1024 count=4194304\n"})}),"\n",(0,a.jsx)(n.p,{children:"Set file permissions:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"chmod 0600 /swapfile\n"})}),"\n",(0,a.jsx)(n.p,{children:"Make it swap:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mkswap /swapfile\n"})}),"\n",(0,a.jsx)(n.p,{children:"Activate the swap file immediately:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"swapon /swapfile\n"})}),"\n",(0,a.jsx)(n.p,{children:"Now use the first set of commands to check the status of swap memory."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"[root@almalinux ~]# free -h\n               total        used        free      shared  buff/cache   available\nMem:           7.7Gi       405Mi       3.3Gi        16Mi       4.2Gi       7.3Gi\nSwap:          4.0Gi          0B       4.0Gi\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Edit the ",(0,a.jsx)(n.code,{children:"/etc/fstab"})," file with the following entries to enable the swap file at\nboot time and make it permanent:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"/swapfile none swap defaults 0 0\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Optionally, adjust the kernel parameters by adding following to\n",(0,a.jsx)(n.code,{children:"/etc/sysctl.conf"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"vm.swappiness=10\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.strong,{children:"swappiness"})," value can be in the range [0, 100]. The higher the parameter\nvalue, the more aggressively inactive processes are swapped out from physical\nmemory leaving more room for caching. The lower the value, the less they are\nswapped, forcing filesystem buffers to be emptied. On most systems,\n",(0,a.jsx)(n.strong,{children:"vm.swappiness"})," is set to 60 by default. Read more about it ",(0,a.jsx)(n.a,{href:"https://pranabdas.github.io/drive/documents/technical-articles/what-does-swappiness-do.pdf",children:"here"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Restart daemons:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"systemctl daemon-reload\n"})}),"\n",(0,a.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_storage_devices/getting-started-with-swap_managing-storage-devices#creating-a-swap-file_getting-started-with-swap",children:"Getting started with swap | Red Hat Product Documentation"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://pranabdas.github.io/drive/documents/technical-articles/what-does-swappiness-do.pdf",children:"What does swappiness do?"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var a=s(6540);const t={},r=a.createContext(t);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);