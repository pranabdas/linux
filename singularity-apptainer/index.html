<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-singularity-apptainer" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Singularity and Apptainer • Linux tutorial</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://pranabdas.github.io/linux/singularity-apptainer /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=theme-color content=#06445c /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="Singularity and Apptainer • Linux tutorial"/><meta data-rh=true name=description content="Apptainer is a fork of Singularity project, both projects are maintained"/><meta data-rh=true property=og:description content="Apptainer is a fork of Singularity project, both projects are maintained"/><link data-rh=true rel=icon href=/linux/img/favicon.png /><link data-rh=true rel=canonical href=https://pranabdas.github.io/linux/singularity-apptainer /><link data-rh=true rel=alternate href=https://pranabdas.github.io/linux/singularity-apptainer hreflang=en /><link data-rh=true rel=alternate href=https://pranabdas.github.io/linux/singularity-apptainer hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://pranabdas.github.io/linux/category/misc","name":"Misc","position":1},{"@type":"ListItem","item":"https://pranabdas.github.io/linux/singularity-apptainer","name":"Singularity and Apptainer","position":2}]}</script><link rel=stylesheet href=/linux/assets/css/styles.eb429d8a.css /><script src=/linux/assets/js/runtime~main.61eb9693.js defer></script><script src=/linux/assets/js/main.54a08235.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/linux/img/favicon.png /><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/linux/><div class=navbar__logo><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">Linux tutorial</b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/linux/>Docs</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/linux/>Linux Tutorial</a><li><a href=https://pranabdas.github.io/docs/ target=_self rel="noopener noreferrer" class=dropdown__link>~ ~ ~ Other Docs ~ ~ ~</a><li><a href=https://pranabdas.github.io/arpespythontools/ target=_self rel="noopener noreferrer" class=dropdown__link>ARPES Python Tools</a><li><a href=https://pranabdas.github.io/c-cpp/ target=_self rel="noopener noreferrer" class=dropdown__link>C and C++ Programming</a><li><a href=https://pranabdas.github.io/condmat-notes/ target=_self rel="noopener noreferrer" class=dropdown__link>Condensed Matter Notes</a><li><a href=https://pranabdas.github.io/fortran/ target=_self rel="noopener noreferrer" class=dropdown__link>Fortran Programming</a><li><a href=https://pranabdas.github.io/javascript/ target=_self rel="noopener noreferrer" class=dropdown__link>Javascript Tutorial</a><li><a href=https://pranabdas.github.io/machine-learning/ target=_self rel="noopener noreferrer" class=dropdown__link>Machine Learning Notes</a><li><a href=https://pranabdas.github.io/openmx/ target=_self rel="noopener noreferrer" class=dropdown__link>OpenMX tutorial</a><li><a href=https://pranabdas.github.io/python-tutorial/ target=_self rel="noopener noreferrer" class=dropdown__link>Python Tutorial</a><li><a href=https://pranabdas.github.io/espresso/ target=_self rel="noopener noreferrer" class=dropdown__link>Quantum Espresso Tutorial</a><li><a href=https://pranabdas.github.io/rust/ target=_self rel="noopener noreferrer" class=dropdown__link>Rust Programming</a><li><a href=https://pranabdas.github.io/arpes-manual/ target=_self rel="noopener noreferrer" class=dropdown__link>SUV ARPES Manual</a><li><a href=https://pranabdas.github.io/suvtools/ target=_self rel="noopener noreferrer" class=dropdown__link>SUV Python Tools</a></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/pranabdas/linux target=_self rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository" title="Visit project repository in GitHub"></a><a href=https://pranabdas.github.io target=_self rel="noopener noreferrer" class="navbar__item navbar__link header-homepage-link" aria-label="About me" title="Go to Pranab's Homepage"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class="navbar__search-input searchInput_YFbd" value="" /><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/linux/><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--dark_xIcU"/><b>Linux tutorial</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/><span title=Welcome class=linkLabel_WmDU>Welcome</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/commandline><span title=Commandline class=linkLabel_WmDU>Commandline</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/vi><span title="Vi editor" class=linkLabel_WmDU>Vi editor</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/git><span title=Git class=linkLabel_WmDU>Git</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/docker><span title=Docker class=linkLabel_WmDU>Docker</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/shell-scripting><span title="Shell scripting" class=linkLabel_WmDU>Shell scripting</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/regex><span title="Regular Expression" class=linkLabel_WmDU>Regular Expression</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/linux/category/misc><span title=Misc class=categoryLinkLabel_W154>Misc</span></a><button aria-label="Collapse sidebar category 'Misc'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/setup><span title="Linux setup" class=linkLabel_WmDU>Linux setup</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/administration><span title="Linux administration" class=linkLabel_WmDU>Linux administration</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/filesystem><span title=Filesystem class=linkLabel_WmDU>Filesystem</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/network-setup><span title="Network setup" class=linkLabel_WmDU>Network setup</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/firewall><span title=Firewall class=linkLabel_WmDU>Firewall</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/network-security><span title="Network security" class=linkLabel_WmDU>Network security</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/tls-key-management><span title="TLS Key management" class=linkLabel_WmDU>TLS Key management</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/storage-management><span title="Storage Management" class=linkLabel_WmDU>Storage Management</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/selinux><span title=SELinux class=linkLabel_WmDU>SELinux</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/jq><span title="jq - JSON Processor" class=linkLabel_WmDU>jq - JSON Processor</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/image-manipulation><span title="Image manipulation" class=linkLabel_WmDU>Image manipulation</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/pgp><span title="PGP Encryption" class=linkLabel_WmDU>PGP Encryption</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/gnuplot><span title=gnuplot class=linkLabel_WmDU>gnuplot</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/apache><span title=Apache class=linkLabel_WmDU>Apache</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/nextcloud><span title=NextCloud class=linkLabel_WmDU>NextCloud</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/jenkins><span title="CI/CD with Jenkins" class=linkLabel_WmDU>CI/CD with Jenkins</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/hpc><span title=HPC class=linkLabel_WmDU>HPC</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/module><span title=Modules class=linkLabel_WmDU>Modules</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/linux/singularity-apptainer><span title="Singularity and Apptainer" class=linkLabel_WmDU>Singularity and Apptainer</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/brew><span title=Homebrew class=linkLabel_WmDU>Homebrew</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/latex><span title=LaTeX class=linkLabel_WmDU>LaTeX</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/vagrant><span title=Vagrant class=linkLabel_WmDU>Vagrant</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/wsl><span title=WSL class=linkLabel_WmDU>WSL</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/privacy><span title="Privacy tips" class=linkLabel_WmDU>Privacy tips</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/more-tips-tricks><span title="More tips and tricks" class=linkLabel_WmDU>More tips and tricks</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/resources><span title=Resources class=linkLabel_WmDU>Resources</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/license><span title=License class=linkLabel_WmDU>License</span></a></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/linux/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/linux/category/misc><span>Misc</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Singularity and Apptainer</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Singularity and Apptainer</h1></header><p>Apptainer is a fork of Singularity project, both projects are maintained
separately. We can use <code>apptainer</code> and <code>singularity</code> commands interchangeably.</p>
<p>Install Apptainer in RHEL based systems:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">dnf </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> epel-release</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">dnf </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> apptainer</span><br/></span></code></pre></div></div>
<p>Install in Debian based systems:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>sudo</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>apt</span><span class="token plain"> update </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>sudo</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>apt</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>wget</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>curl</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    fuse3 </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    libfuse3-3 </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    uidmap </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    squashfs-tools</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># download latest version of apptainer</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>VER</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable function" style=color:#d73a49>curl</span><span class="token variable" style=color:#36acaa> </span><span class="token variable parameter variable" style=color:#36acaa>-s</span><span class="token variable" style=color:#36acaa> https://api.github.com/repos/apptainer/apptainer/releases/latest </span><span class="token variable operator" style=color:#393A34>|</span><span class="token variable" style=color:#36acaa> </span><span class="token variable function" style=color:#d73a49>grep</span><span class="token variable" style=color:#36acaa> tag_name </span><span class="token variable operator" style=color:#393A34>|</span><span class="token variable" style=color:#36acaa> </span><span class="token variable function" style=color:#d73a49>cut</span><span class="token variable" style=color:#36acaa> </span><span class="token variable parameter variable" style=color:#36acaa>-d</span><span class="token variable" style=color:#36acaa> </span><span class="token variable string" style=color:#e3116c>'"'</span><span class="token variable" style=color:#36acaa> </span><span class="token variable parameter variable" style=color:#36acaa>-f</span><span class="token variable" style=color:#36acaa> </span><span class="token variable number" style=color:#36acaa>4</span><span class="token variable" style=color:#36acaa> </span><span class="token variable operator" style=color:#393A34>|</span><span class="token variable" style=color:#36acaa> </span><span class="token variable function" style=color:#d73a49>sed</span><span class="token variable" style=color:#36acaa> </span><span class="token variable string" style=color:#e3116c>'s/v//'</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>wget</span><span class="token plain"> https://github.com/apptainer/apptainer/releases/download/v</span><span class="token variable" style=color:#36acaa>${VER}</span><span class="token plain">/apptainer_</span><span class="token variable" style=color:#36acaa>${VER}</span><span class="token plain">_amd64.deb</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>sudo</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>apt</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> ./apptainer_</span><span class="token variable" style=color:#36acaa>${VER}</span><span class="token plain">_amd64.deb</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> apptainer_</span><span class="token variable" style=color:#36acaa>${VER}</span><span class="token plain">_amd64.deb</span><br/></span></code></pre></div></div>
<p>Pull a docker image (it will convert and write to SIF format):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer pull docker://nvcr.io/hpc/quantum_espresso:qe-7.3.1</span><br/></span></code></pre></div></div>
<p>Run a program via apptainer:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> /qe-7.4.sif /opt/q-e-qe-7.4.1/bin/pw.x </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> pw.in </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>tee</span><span class="token plain"> pw.out</span><br/></span></code></pre></div></div>
<p>Bind a directory (some directories are mapped automatically, such as current
working directory):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--bind</span><span class="token plain"> /export:/export /qe-7.4.sif /opt/q-e-qe-7.4.1/bin/pw.x </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> pw.in </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>tee</span><span class="token plain"> pw.out</span><br/></span></code></pre></div></div>
<p>Launch apptainer via MPI:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">mpirun </span><span class="token parameter variable" style=color:#36acaa>-np</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"> apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> /qe-7.4.sif /opt/q-e-qe-7.4.1/bin/pw.x </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> pw.in </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>tee</span><span class="token plain"> pw.out</span><br/></span></code></pre></div></div>
<p>How to pass environment variable to the container:</p>
<ol>
<li class="">We can pass variable with <code>--env</code> flag.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--env</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>MY_VARIABLE</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"some_value"</span><span class="token plain"> my-container.sif </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$MY_VARIABLE</span><br/></span></code></pre></div></div>
<ol start=2>
<li class="">We can set variables with <code>APPTAINERENV_</code> or <code>SINGULARITYENV_</code> prefix:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>APPTAINERENV_MY_VARIABLE</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"some_value"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> my-container.sif </span><span class="token function" style=color:#d73a49>env</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>grep</span><span class="token plain"> MY_VARIABLE</span><br/></span></code></pre></div></div>
<p>Also there are <code>APPTAINERENV_PREPEND_PATH</code> and <code>APPTAINERENV_APPEND_PATH</code> to
modify <code>PATH</code> variable.</p>
<p>Example Apptainer definition file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>espresso.def</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">Bootstrap: </span><span class="token function" style=color:#d73a49>docker</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">From: almalinux:9</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">%labels</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    Maintainer Pranab Das</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    Version QE-7.4.1</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">%environment</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>OMP_NUM_THREADS</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style=color:#36acaa>PATH</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">/usr/lib64/openmpi/bin:</span><span class="token environment constant" style=color:#36acaa>$PATH</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>LD_LIBRARY_PATH</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">/usr/lib64/openmpi/lib:</span><span class="token variable" style=color:#36acaa>$LD_LIBRARY_PATH</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">%post</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    dnf </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> epel-release</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    dnf config-manager --set-enabled crb</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    dnf groupinstall </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Development Tools"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    dnf </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-y</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>wget</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        gcc </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        gcc-c++ </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        gcc-gfortran </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        openblas-devel </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        lapack-devel </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        fftw-devel </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        openmpi-devel </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        scalapack-openmpi-devel </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        libomp-devel</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>wget</span><span class="token plain"> https://github.com/QEF/q-e/archive/refs/tags/qe-7.4.1.tar.gz</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>tar</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-xf</span><span class="token plain"> qe-7.4.1.tar.gz</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-f</span><span class="token plain"> qe-7.4.1.tar.gz</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">cd</span><span class="token plain"> q-e-qe-7.4.1</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>OMP_NUM_THREADS</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style=color:#36acaa>PATH</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">/usr/lib64/openmpi/bin:</span><span class="token environment constant" style=color:#36acaa>$PATH</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>LD_LIBRARY_PATH</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">/usr/lib64/openmpi/lib:</span><span class="token variable" style=color:#36acaa>$LD_LIBRARY_PATH</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    ./configure </span><span class="token assign-left variable" style=color:#36acaa>CC</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">mpicc </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token assign-left variable" style=color:#36acaa>FC</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">mpifort </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token assign-left variable" style=color:#36acaa>F77</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">mpifort </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token assign-left variable" style=color:#36acaa>F90</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">mpifort </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token assign-left variable" style=color:#36acaa>MPIF90</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">mpif90 </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        --enable-parallel </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        --enable-openmp </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        --with-scalapack</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">yes </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token parameter variable" style=color:#36acaa>--prefix</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">/opt/qe-7.4.1</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>make</span><span class="token plain"> all -j</span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable" style=color:#36acaa>nproc</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>make</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>..</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-rf</span><span class="token plain"> q-e-qe-7.4.1</span><br/></span></code></pre></div></div>
<p>Build container:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer build espresso.sif espresso.def</span><br/></span></code></pre></div></div>
<p>Recover apptainer definition file from an image. Apptainer file is embedded into
the SIF image.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">image_name.sif</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token function" style=color:#d73a49>cat</span><span class="token plain"> /.singularity.d/Singularity</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=sandbox-mode>Sandbox mode<a href=#sandbox-mode class=hash-link aria-label="Direct link to Sandbox mode" title="Direct link to Sandbox mode" translate=no>​</a></h2>
<p>We can test commands interactively in sandbox mode. Create a sandbox with
<code>--sandbox</code> or <code>-s</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer build </span><span class="token parameter variable" style=color:#36acaa>--sandbox</span><span class="token plain"> test_sandbox/ docker://ubuntu:latest</span><br/></span></code></pre></div></div>
<p>This will create a standard directory named test_sandbox that contains full
Linux OS tree (<code>/bin</code>, <code>/etc</code>, <code>/usr</code>).</p>
<p>Now to install packages and save them to the sandbox folder, we need to enter
into the container in writable mode (use <code>--writable</code> or <code>-w</code> flag). We will
also need <code>--fakeroot</code> or <code>-f</code> flag to install software as root inside the
container:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer shell </span><span class="token parameter variable" style=color:#36acaa>--writable</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--fakeroot</span><span class="token plain"> test_sandbox/</span><br/></span></code></pre></div></div>
<p>Inside the apptainer shell, we can install packages and experiment
interactively, for example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">dnf </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> python3</span><br/></span></code></pre></div></div>
<p>We can package the sandbox directory into a SIF image:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer build </span><span class="token parameter variable" style=color:#36acaa>-f</span><span class="token plain"> espresso.sif test_sandbox/</span><br/></span></code></pre></div></div>
<p>After the container is build and saved as SIF image, we may delete our sandbox
folder. We need to set appropriate permission in order to be able to delete:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>chmod</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-R</span><span class="token plain"> u+rwX test_sandbox</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-rf</span><span class="token plain"> test_sandbox</span><br/></span></code></pre></div></div>
<p>Cleanup apptainer cache:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer cache clean </span><span class="token parameter variable" style=color:#36acaa>--force</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=managing-env-variables>Managing ENV variables<a href=#managing-env-variables class=hash-link aria-label="Direct link to Managing ENV variables" title="Direct link to Managing ENV variables" translate=no>​</a></h2>
<p>Apptainer stores ENV variables in severals files under <code>/.singularity.d/env</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ </span><span class="token function" style=color:#d73a49>ls</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-l</span><span class="token plain"> /.singularity.d/env</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">total </span><span class="token number" style=color:#36acaa>10</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">-rwxr-xr-x </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root </span><span class="token number" style=color:#36acaa>1337</span><span class="token plain"> Aug  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> 01:32 01-base.sh</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">-rwxr-xr-x </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root   </span><span class="token number" style=color:#36acaa>85</span><span class="token plain"> Aug  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> 01:32 </span><span class="token number" style=color:#36acaa>10</span><span class="token plain">-docker2singularity.sh</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">-rwxr-xr-x </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root </span><span class="token number" style=color:#36acaa>1707</span><span class="token plain"> Dec  </span><span class="token number" style=color:#36acaa>6</span><span class="token plain"> 06:18 </span><span class="token number" style=color:#36acaa>90</span><span class="token plain">-environment.sh</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">-rwxr-xr-x </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root    </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> Dec  </span><span class="token number" style=color:#36acaa>6</span><span class="token plain"> 06:09 </span><span class="token number" style=color:#36acaa>94</span><span class="token plain">-appsbase.sh</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">-rwxr-xr-x </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root </span><span class="token number" style=color:#36acaa>3052</span><span class="token plain"> Aug  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> 01:32 </span><span class="token number" style=color:#36acaa>95</span><span class="token plain">-apps.sh</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">-rwxr-xr-x </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root </span><span class="token number" style=color:#36acaa>1568</span><span class="token plain"> Aug  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> 01:32 </span><span class="token number" style=color:#36acaa>99</span><span class="token plain">-base.sh</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">-rwxr-xr-x </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root  </span><span class="token number" style=color:#36acaa>922</span><span class="token plain"> Aug  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> 01:32 </span><span class="token number" style=color:#36acaa>99</span><span class="token plain">-runtimevars.sh</span><br/></span></code></pre></div></div>
<p>Notice the numerical prefix, they are sourced in alphabetical order by the
shell. The ENV variables set in the <code>%environment</code> definition, goes to
<code>90-environment.sh</code>. This file is also symlinked from <code>/environment</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> base.sif </span><span class="token function" style=color:#d73a49>ls</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-l</span><span class="token plain"> /environment</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">lrwxrwxrwx </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> root root </span><span class="token number" style=color:#36acaa>36</span><span class="token plain"> Dec  </span><span class="token number" style=color:#36acaa>6</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>13</span><span class="token plain">:29 /environment -</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> .singularity.d/env/90-environment.sh</span><br/></span></code></pre></div></div>
<p>However, above files are regenerated/<wbr/>overwritten during the build, they
are not carried over from the base image. We can save ENV variables to custom
files under the above folder, such files are copied to subsequent child images,
and automatically sourced by apptainer.</p>
<p>Such a file could be <code>91-environment.sh</code> where we can write variables during the
build (<code>%post</code> section):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">%post</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'export PATH=/test/path:$PATH'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>>></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$APPTAINER_ENVIRONMENT</span><br/></span></code></pre></div></div>
<p>or,</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">%post</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>cat</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>>></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$APPTAINER_ENVIRONMENT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;&lt;</span><span class="token string" style=color:#e3116c>'EOF'</span><br/></span><span class=token-line style=color:#393A34><span class="token string" style=color:#e3116c>export ONEAPI_ROOT=/opt/intel-2023.1</span><br/></span><span class=token-line style=color:#393A34><span class="token string" style=color:#e3116c>export TBBROOT=$ONEAPI_ROOT/tbb/2021.11</span><br/></span><span class=token-line style=color:#393A34><span class="token string" style=color:#e3116c>EOF</span><br/></span></code></pre></div></div>
<p>Notice the single quoted <code>'EOF'</code>, this prevents variable substitution in the
heredoc block.</p>
<p>We can inspect ENV variables with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">apptainer inspect </span><span class="token parameter variable" style=color:#36acaa>--environment</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">image-name.sif</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">apptainer </span><span class="token builtin class-name">exec</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">image-name.sif</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token function" style=color:#d73a49>printenv</span><span class="token plain"> </span><span class="token environment constant" style=color:#36acaa>PATH</span><br/></span></code></pre></div></div>
<p>During build phase, if required, we can source variables with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-f</span><span class="token plain"> /.singularity.d/env/91-environment.sh </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>then</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">.</span><span class="token plain"> /.singularity.d/env/91-environment.sh</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>fi</span><br/></span></code></pre></div></div>
<p>or source all ENV files:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token for-or-select variable" style=color:#36acaa>script</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> /.singularity.d/env/*.sh</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-f</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>$script</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>then</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>$script</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>fi</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>done</span><br/></span></code></pre></div></div>
<p>Optionally, we can save variables in custom files, e.g., <code>91-oneapi.sh</code>,
<code>92-nvhpc.sh</code> etc.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=managing-sif-images-with-oras>Managing SIF images with ORAS<a href=#managing-sif-images-with-oras class=hash-link aria-label="Direct link to Managing SIF images with ORAS" title="Direct link to Managing SIF images with ORAS" translate=no>​</a></h2>
<p>Install ORAS in macos:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">brew </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> oras</span><br/></span></code></pre></div></div>
<p>Login to GitHub Container Registry with ORAS (requires GitHub personal access
token with sufficient permission):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$CR_PAT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> oras login ghcr.io </span><span class="token parameter variable" style=color:#36acaa>-u</span><span class="token plain"> pranabdas --password-stdin</span><br/></span></code></pre></div></div>
<p>Push a file to GHCR:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">oras push ghcr.io/pranabdas/drive:1.0.0 </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    --artifact-type application/text </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    ./sample.txt</span><br/></span></code></pre></div></div>
<p>Fetch details about an object:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">oras manifest fetch ghcr.io/pranabdas/drive:1.0.0</span><br/></span></code></pre></div></div>
<p>Print SHA-256-SUM of an object:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">oras manifest fetch ghcr.io/pranabdas/drive:1.0.0 </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> jq </span><span class="token string" style=color:#e3116c>'.layers[0].digest'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>awk</span><span class="token plain"> -F: </span><span class="token string" style=color:#e3116c>'{print $2}'</span><br/></span></code></pre></div></div>
<p>Pull an object:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">oras pull ghcr.io/pranabdas/drive:1.0.0</span><br/></span></code></pre></div></div>
<p>Pull and write object to a specific directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">oras pull ghcr.io/pranabdas/drive:1.0.0 </span><span class="token parameter variable" style=color:#36acaa>--output</span><span class="token plain"> /opt</span><br/></span></code></pre></div></div>
<p>An ORAS image can be made associated with a repository by uploading to the
repository namespace:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">ghcr.io/pranabdas/</span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">repository</span><span class="token operator" style=color:#393A34>></span><span class="token plain">/</span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">image</span><span class="token operator" style=color:#393A34>></span><span class="token plain">:</span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">tag</span><span class="token operator" style=color:#393A34>></span><br/></span></code></pre></div></div>
<p>We may need to specify per file media type <code>&lt;file-name>:&lt;media-type></code> to set
artifact type correctly:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">oras push ghcr.io/pranabdas/ubuntu.sif </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  --artifact-type </span><span class="token string" style=color:#e3116c>"application/vnd.sylabs.sif.layer.v1.sif"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token string" style=color:#e3116c>"qe.sif:application/vnd.sylabs.sif.layer.v1.sif"</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=run-apptainer-in-github-codespaces>Run apptainer in GitHub Codespaces<a href=#run-apptainer-in-github-codespaces class=hash-link aria-label="Direct link to Run apptainer in GitHub Codespaces" title="Direct link to Run apptainer in GitHub Codespaces" translate=no>​</a></h2>
<ol>
<li class="">Enable via docker-in-docker:</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token property" style=color:#36acaa>"features"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token property" style=color:#36acaa>"ghcr.io/devcontainers/features/docker-in-docker:2"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token property" style=color:#36acaa>"enableNonRootDocker"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"true"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><br/></span></code></pre></div></div>
<ol start=2>
<li class="">If you do not need full docker-in-docker functionality, execute following
commands to enable required permissions:</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token property" style=color:#36acaa>"name"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"My Codespace"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token property" style=color:#36acaa>"runArgs"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string" style=color:#e3116c>"--cap-add=SYS_ADMIN"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string" style=color:#e3116c>"--security-opt"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"apparmor=unconfined"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string" style=color:#e3116c>"--device=/dev/fuse"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string" style=color:#e3116c>"--security-opt"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"systempaths=unconfined"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<ol start=3>
<li class="">Run <code>--privileged</code> mode (less secure than option 2):</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token property" style=color:#36acaa>"name"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"My Codespace"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token property" style=color:#36acaa>"runArgs"</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"--privileged"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=resources>Resources<a href=#resources class=hash-link aria-label="Direct link to Resources" title="Direct link to Resources" translate=no>​</a></h2>
<ul>
<li class=""><a href=https://docs.sylabs.io/guides/latest/user-guide/ target=_blank rel="noopener noreferrer" class="">https://docs.sylabs.io/guides/latest/user-guide/</a></li>
<li class=""><a href=https://apptainer.org/docs/user/main/index.html target=_blank rel="noopener noreferrer" class="">https://apptainer.org/docs/user/main/index.html</a></li>
<li class=""><a href=https://oras.land target=_blank rel="noopener noreferrer" class="">https://oras.land</a></li>
<li class=""><a href=https://doi.org/10.1145/3332186.3332192 target=_blank rel="noopener noreferrer" class="">Singularity: Simple, secure containers for compute-driven workloads</a></li>
<li class=""><a href=https://doi.org/10.1051/epjconf/202429507005 target=_blank rel="noopener noreferrer" class="">Apptainer Without Setuid</a></li>
<li class=""><a href=https://doi.org/10.1109/CANOPIE-HPC49598.2019.00006 target=_blank rel="noopener noreferrer" class="">Evaluation and Benchmarking of Singularity MPI containers on EU Research e-Infrastructure</a></li>
<li class=""><a href=https://doi.org/10.3389/fbinf.2021.757291 target=_blank rel="noopener noreferrer" class="">Singularity Containers Improve Reproducibility and Ease of Use in Computational Image Analysis Workflows</a></li>
<li class=""><a href=https://doi.org/10.1109/CANOPIEHPC54579.2021.00007 target=_blank rel="noopener noreferrer" class="">Feasibility of Running Singularity Containers with Hybrid MPI on NASA High-End Computing Resources</a></li>
<li class=""><a href=https://doi.org/10.1371/journal.pone.0177459 target=_blank rel="noopener noreferrer" class="">Singularity: Scientific containers for mobility of compute</a></li>
<li class=""><a href=https://doi.org/10.1371/journal.pone.0188511 target=_blank rel="noopener noreferrer" class="">Enhancing reproducibility in scientific computing: Metrics and registry for Singularity containers</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/pranabdas/linux/blob/main/docs/28-singularity-apptainer.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/linux/module><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Modules</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/linux/brew><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Homebrew</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#sandbox-mode class="table-of-contents__link toc-highlight">Sandbox mode</a><li><a href=#managing-env-variables class="table-of-contents__link toc-highlight">Managing ENV variables</a><li><a href=#managing-sif-images-with-oras class="table-of-contents__link toc-highlight">Managing SIF images with ORAS</a><li><a href=#run-apptainer-in-github-codespaces class="table-of-contents__link toc-highlight">Run apptainer in GitHub Codespaces</a><li><a href=#resources class="table-of-contents__link toc-highlight">Resources</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 Pranab Das. All rights reserved.</div></div></div></footer></div></body>