<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tls-key-management" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>Managing public key infrastructure • Linux tutorial</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://pranabdas.github.io/linux/tls-key-management><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=theme-color content=#06445c><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Managing public key infrastructure • Linux tutorial"><meta data-rh=true name=description content="Generate keys"><meta data-rh=true property=og:description content="Generate keys"><meta data-rh=true name=keywords content=linux,openssl,tls><link data-rh=true rel=icon href=/linux/img/favicon.png><link data-rh=true rel=canonical href=https://pranabdas.github.io/linux/tls-key-management><link data-rh=true rel=alternate href=https://pranabdas.github.io/linux/tls-key-management hreflang=en><link data-rh=true rel=alternate href=https://pranabdas.github.io/linux/tls-key-management hreflang=x-default><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://pranabdas.github.io/linux/category/misc","name":"Misc","position":1},{"@type":"ListItem","item":"https://pranabdas.github.io/linux/tls-key-management","name":"TLS Key management","position":2}]}</script><link rel=stylesheet href=/linux/assets/css/styles.4be96b81.css><script src=/linux/assets/js/runtime~main.05d7ee2b.js defer></script><script src=/linux/assets/js/main.f9e1d559.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/linux/img/favicon.png><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/linux/><div class=navbar__logo><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Linux tutorial</b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/linux/>Docs</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/linux/>Linux Tutorial</a><li><a href=https://pranabdas.github.io/docs/ target=_self rel="noopener noreferrer" class=dropdown__link>~ ~ ~ Other Docs ~ ~ ~</a><li><a href=https://pranabdas.github.io/arpespythontools/ target=_self rel="noopener noreferrer" class=dropdown__link>ARPES Python Tools</a><li><a href=https://pranabdas.github.io/c-cpp/ target=_self rel="noopener noreferrer" class=dropdown__link>C and C++ Programming</a><li><a href=https://pranabdas.github.io/condmat-notes/ target=_self rel="noopener noreferrer" class=dropdown__link>Condensed Matter Notes</a><li><a href=https://pranabdas.github.io/fortran/ target=_self rel="noopener noreferrer" class=dropdown__link>Fortran Programming</a><li><a href=https://pranabdas.github.io/javascript/ target=_self rel="noopener noreferrer" class=dropdown__link>Javascript Tutorial</a><li><a href=https://pranabdas.github.io/machine-learning/ target=_self rel="noopener noreferrer" class=dropdown__link>Machine Learning Notes</a><li><a href=https://pranabdas.github.io/openmx/ target=_self rel="noopener noreferrer" class=dropdown__link>OpenMX tutorial</a><li><a href=https://pranabdas.github.io/python-tutorial/ target=_self rel="noopener noreferrer" class=dropdown__link>Python Tutorial</a><li><a href=https://pranabdas.github.io/espresso/ target=_self rel="noopener noreferrer" class=dropdown__link>Quantum Espresso Tutorial</a><li><a href=https://pranabdas.github.io/rust/ target=_self rel="noopener noreferrer" class=dropdown__link>Rust Programming</a><li><a href=https://pranabdas.github.io/arpes-manual/ target=_self rel="noopener noreferrer" class=dropdown__link>SUV ARPES Manual</a><li><a href=https://pranabdas.github.io/suvtools/ target=_self rel="noopener noreferrer" class=dropdown__link>SUV Python Tools</a></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/pranabdas/linux target=_self rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository" title="Visit project repository in GitHub"></a><a href=https://pranabdas.github.io target=_self rel="noopener noreferrer" class="navbar__item navbar__link header-homepage-link" aria-label="About me" title="Go to Pranab's Homepage"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/linux/><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/linux/img/favicon.png alt=Logo class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Linux tutorial</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/>Welcome</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/commandline>Commandline</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/vi>Vi editor</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/git>Git</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/docker>Docker</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/shell-scripting>Shell scripting</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/regex>Regular Expression</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/linux/category/misc>Misc</a><button aria-label="Collapse sidebar category 'Misc'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/setup>Linux setup</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/administration>Linux administration</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/filesystem>Filesystem</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/network-setup>Network setup</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/firewall>Firewall</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/network-security>Network security</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/linux/tls-key-management>TLS Key management</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/storage-management>Storage Management</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/selinux>SELinux</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/jq>jq</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/pgp>PGP Encryption</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/gnuplot>gnuplot</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/apache>Apache</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/nextcloud>NextCloud</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/jenkins>CI/CD with Jenkins</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/hpc>HPC</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/module>Modules</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/brew>Homebrew</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/latex>LaTeX</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/vagrant>Vagrant</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/wsl>WSL</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/privacy>Privacy tips</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/linux/more-tips-tricks>More tips and tricks</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/resources>Resources</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/linux/license>License</a></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/linux/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/linux/category/misc><span>Misc</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>TLS Key management</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Managing public key infrastructure</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=generate-keys>Generate keys<a href=#generate-keys class=hash-link aria-label="Direct link to Generate keys" title="Direct link to Generate keys">​</a></h2>
<p>Generate 2048 bit RSA key using openssl:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl genrsa </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> private.key </span><span class="token number" style=color:#36acaa>2048</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_BuS1><p>Key with higher bit size (say, RSA 4096 bit or even 8192 bit) are more secure
but it comes with additional computing overhead for encryption and decryption.</div></div>
<p>The key generated in the above command contains both private and the public
keys. Extract the public key:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl rsa </span><span class="token parameter variable" style=color:#36acaa>-pubout</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> private.key</span><br></span></code></pre></div></div>
<p>We can encrypt the <code>private.key</code> with a passphrase during creation instead of
writing in plaintext:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl genrsa </span><span class="token parameter variable" style=color:#36acaa>-aes256</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> private.key </span><span class="token number" style=color:#36acaa>2048</span><br></span></code></pre></div></div>
<p>Convert an encrypted key file to a un-encrypted file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl rsa </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> private.key </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> unencrypted.key</span><br></span></code></pre></div></div>
<p>Inspect various details in a private key:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl rsa </span><span class="token parameter variable" style=color:#36acaa>-text</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> private.key</span><br></span><span class=token-line style=color:#393A34><span class="token plain">openssl rsa </span><span class="token parameter variable" style=color:#36acaa>-check</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-noout</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> private.key</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=certificate-signing-request>Certificate Signing Request<a href=#certificate-signing-request class=hash-link aria-label="Direct link to Certificate Signing Request" title="Direct link to Certificate Signing Request">​</a></h2>
<p>Create CSR (interactively, it will ask for various required and optional
parameters):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-new</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-key</span><span class="token plain"> private.key </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> domain.example.com.csr</span><br></span></code></pre></div></div>
<p>Create CSR non-interactively:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-new</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-key</span><span class="token plain"> private.key </span><span class="token parameter variable" style=color:#36acaa>-noenc</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-subj</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'/CN=example.com/O=Example Inc./OU=Engineering/C=US/ST=California/L=San Francisco/emailAddress=email@example.com'</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-addext</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"keyUsage = digitalSignature,keyAgreement"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-addext</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"extendedKeyUsage = serverAuth, clientAuth"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> example.com.csr</span><br></span></code></pre></div></div>
<p>Create private key and csr together:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-new</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-noenc</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-subj</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'/CN=domain.example.com/O=Example Ltd/C=SG/L=Singapore'</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-newkey</span><span class="token plain"> rsa:2048 </span><span class="token parameter variable" style=color:#36acaa>-keyout</span><span class="token plain"> private2.key </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> domain2.example.com.csr</span><br></span></code></pre></div></div>
<p>Check CSR details:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-text</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-noout</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-verify</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> mongo.csr.pem</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=self-sign-certificates>Self-sign certificates<a href=#self-sign-certificates class=hash-link aria-label="Direct link to Self-sign certificates" title="Direct link to Self-sign certificates">​</a></h2>
<p>Self-signed certificates are intended for testing and development purposes only.
Generate a self-signed certificate for root of trust:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-x509</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-days</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>365</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-noenc</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-subj</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'/CN=ROOT/O=ROOT/C=SG/L=Singapore'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-key</span><span class="token plain"> private.key </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> ca.crt</span><br></span></code></pre></div></div>
<p>Use the self-signed root signing certificate to generate a signed certificate
from the certificate request:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl x509 </span><span class="token parameter variable" style=color:#36acaa>-req</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> domain.example.com.csr </span><span class="token parameter variable" style=color:#36acaa>-days</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>365</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-CA</span><span class="token plain"> ca.crt </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-CAkey</span><span class="token plain"> private.key </span><span class="token parameter variable" style=color:#36acaa>-CAcreateserial</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> domain.example.com.crt</span><br></span></code></pre></div></div>
<p>Do all the above in a single step:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-new</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-x509</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-days</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>365</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-noenc</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-newkey</span><span class="token plain"> rsa:2048 </span><span class="token parameter variable" style=color:#36acaa>-keyout</span><span class="token plain"> private.key </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> public.crt </span><span class="token parameter variable" style=color:#36acaa>-subj</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'/CN=domain.example.com/O=Example Ltd/C=SG/L=Singapore'</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=use-ca-to-sign>Use CA to sign<a href=#use-ca-to-sign class=hash-link aria-label="Direct link to Use CA to sign" title="Direct link to Use CA to sign">​</a></h2>
<p>For production usage, we should be using a third-party CA authority. In case of
a own CA implementation, we could use a separate root or intermediatory CA key
and certificate to sign. Better care should be taken when creating a root
certificate, e.g., a larger size key and encrypt the key file.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl genrsa </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> ca.key </span><span class="token parameter variable" style=color:#36acaa>-aes256</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>8192</span><br></span></code></pre></div></div>
<p>Generate CA public certificate:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-x509</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-new</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-extensions</span><span class="token plain"> v3_ca </span><span class="token parameter variable" style=color:#36acaa>-key</span><span class="token plain"> ca.key </span><span class="token parameter variable" style=color:#36acaa>-days</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>365</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> ca.crt </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-subj</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'/CN=ca.example.com/O=CA Inc./C=SG/L=Singapore'</span><br></span></code></pre></div></div>
<p>Sign CSR:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl x509 </span><span class="token parameter variable" style=color:#36acaa>-req</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> domain.example.com.csr </span><span class="token parameter variable" style=color:#36acaa>-CA</span><span class="token plain"> ca.crt </span><span class="token parameter variable" style=color:#36acaa>-CAkey</span><span class="token plain"> ca.key </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-days</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>365</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> domain.example.com.crt</span><br></span></code></pre></div></div>
<p>Check certificate details:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl x509 </span><span class="token parameter variable" style=color:#36acaa>-text</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-noout</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> domain.example.com.crt</span><br></span></code></pre></div></div>
<p>Verify:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl verify </span><span class="token parameter variable" style=color:#36acaa>-CAfile</span><span class="token plain"> ca.crt domain.example.com.crt</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=setup-root-ca>Setup root CA<a href=#setup-root-ca class=hash-link aria-label="Direct link to Setup root CA" title="Direct link to Setup root CA">​</a></h2>
<p>A root CA model can better protect the integrity of public key infrastructure.
Root CA is not usually used to sign server or client certificates, instead it is
used to sign one or more intermediary certificates to grant them power to sign
other certificates. In the event a CA Intermediary private key is compromised,
the CA Intermediary can be added to a certificate revocation list and all of the
certificates that are signed by the Intermediary are automatically invalidated.</p>
<ol>
<li>Create a directory (it must be restricted location) to store all of the
CA-related data:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>mkdir</span><span class="token plain"> /root/ca </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$_</span><br></span></code></pre></div></div>
<ol start=2>
<li>Create directories to contain CA certificates, CA database content,
Certificate Revocation List, all newly issued certificates, and your private
keys:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>mkdir</span><span class="token plain"> certs db crl newcerts private</span><br></span></code></pre></div></div>
<ol start=3>
<li>Protect your private keys to ensure that access to the directory where these
are stored is limited to the root user:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>chmod</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>700</span><span class="token plain"> private</span><br></span></code></pre></div></div>
<ol start=4>
<li>Create the files that will be used for your CA database. The <code>index.txt</code> and
serial files act as a kind of flat file database to keep track of signed
certificates.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>touch</span><span class="token plain"> db/index.txt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">openssl rand </span><span class="token parameter variable" style=color:#36acaa>-hex</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>16</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> db/serial</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1001</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>tee</span><span class="token plain">  db/crlnumber</span><br></span></code></pre></div></div>
<ol start=5>
<li>Create config file (<code>/root/ca/ca-root.conf</code>):</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">default</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">name                    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> root-ca</span><br></span><span class=token-line style=color:#393A34><span class="token plain">domain_suffix           </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> example.com</span><br></span><span class=token-line style=color:#393A34><span class="token plain">aia_url                 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> http://</span><span class="token variable" style=color:#36acaa>$name</span><span class="token builtin class-name">.</span><span class="token variable" style=color:#36acaa>$domain_suffix</span><span class="token plain">/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.crt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">crl_url                 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> http://</span><span class="token variable" style=color:#36acaa>$name</span><span class="token builtin class-name">.</span><span class="token variable" style=color:#36acaa>$domain_suffix</span><span class="token plain">/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.crl</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ocsp_url                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> http://ocsp.</span><span class="token variable" style=color:#36acaa>$name</span><span class="token builtin class-name">.</span><span class="token variable" style=color:#36acaa>$domain_suffix</span><span class="token plain">:9080</span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_ca              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ca_default</span><br></span><span class=token-line style=color:#393A34><span class="token plain">name_opt                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> utf8,esc_ctrl,multiline,lname,align</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ca_dn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">countryName             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AU"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationName        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Example Org"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">commonName              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Root CA"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ca_default</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">home                    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">database                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/db/index.txt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">serial                  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/db/serial</span><br></span><span class=token-line style=color:#393A34><span class="token plain">crlnumber               </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/db/crlnumber</span><br></span><span class=token-line style=color:#393A34><span class="token plain">certificate             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.crt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">private_key             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/private/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.key</span><br></span><span class=token-line style=color:#393A34><span class="token plain">RANDFILE                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/private/random</span><br></span><span class=token-line style=color:#393A34><span class="token plain">new_certs_dir           </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/certs</span><br></span><span class=token-line style=color:#393A34><span class="token plain">unique_subject          </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> no</span><br></span><span class=token-line style=color:#393A34><span class="token plain">copy_extensions         </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> none</span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_days            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3650</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_crl_days        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>30</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_md              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sha256</span><br></span><span class=token-line style=color:#393A34><span class="token plain">policy                  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> policy_strict</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">policy_strict</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># The root CA should only sign intermediary certificates that match.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># See the POLICY FORMAT section of `man ca`.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">countryName             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> match</span><br></span><span class=token-line style=color:#393A34><span class="token plain">stateOrProvinceName     </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationName        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> match</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationalUnitName  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">commonName              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> supplied</span><br></span><span class=token-line style=color:#393A34><span class="token plain">emailAddress            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">policy_loose</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Allow the intermediary CA to sign a more diverse range of certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># See the POLICY FORMAT section of the `ca` manual page.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">countryName             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">stateOrProvinceName     </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">localityName            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationName        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationalUnitName  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">commonName              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> supplied</span><br></span><span class=token-line style=color:#393A34><span class="token plain">emailAddress            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">req</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Standard Req options</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_bits            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4096</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">encrypt_key             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>yes</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_md              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sha256</span><br></span><span class=token-line style=color:#393A34><span class="token plain">utf8                    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>yes</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">string_mask             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> utf8only</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prompt                  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> no</span><br></span><span class=token-line style=color:#393A34><span class="token plain">distinguished_name      </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ca_dn</span><br></span><span class=token-line style=color:#393A34><span class="token plain">req_extensions          </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ca_ext</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ca_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for a the CA root (`man x509v3_config`).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical,CA:true</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical,keyCertSign,cRLSign</span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">intermediary_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for an intermediary CA.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">authorityKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> keyid:always,issuer</span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, CA:true, pathlen:0</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, digitalSignature, cRLSign, keyCertSign</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">server_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for server certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CA:FALSE</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsCertType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> server</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsComment </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OpenSSL Generated Server Certificate"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">authorityKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> keyid,issuer:always</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, digitalSignature, keyEncipherment</span><br></span><span class=token-line style=color:#393A34><span class="token plain">extendedKeyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> serverAuth</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">client_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for client certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CA:FALSE</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsCertType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> client, email</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsComment </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OpenSSL Generated Client Certificate"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">authorityKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> keyid,issuer</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, nonRepudiation, digitalSignature, keyEncipherment</span><br></span><span class=token-line style=color:#393A34><span class="token plain">extendedKeyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> clientAuth, emailProtection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">crl_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extension for CRLs.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>authorityKeyIdentifier</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">keyid:always</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ocsp</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extension for OCSP signing certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CA:FALSE</span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">authorityKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> keyid,issuer</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, digitalSignature</span><br></span><span class=token-line style=color:#393A34><span class="token plain">extendedKeyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, OCSPSigning</span><br></span></code></pre></div></div>
<ol start=6>
<li>Create and Verify the CA Root Key Pair. This is the most valuable key in the
entire infrastructure, ensure that you use a lengthy and suitable passphrase to
protect it.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-new</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-config</span><span class="token plain"> ca-root.conf </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> root-ca.csr </span><span class="token parameter variable" style=color:#36acaa>-keyout</span><span class="token plain"> private/root-ca.key</span><br></span></code></pre></div></div>
<ol start=7>
<li>Create a self-signed certificate by using the CSR and the <code>ca-root.conf</code>
file. You will be prompted for your private key passphrase to continue.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl ca </span><span class="token parameter variable" style=color:#36acaa>-selfsign</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-config</span><span class="token plain"> ca-root.conf </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> root-ca.csr </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> root-ca.crt </span><span class="token parameter variable" style=color:#36acaa>-extensions</span><span class="token plain"> ca_ext</span><br></span></code></pre></div></div>
<p>You can view the db/index.txt file to see the CA root certificate entry:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>cat</span><span class="token plain"> db/index.txt</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">V   291026122304Z        8F75111A8E33B2D109A8BF079C67C83E  unknown /C</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">AU/O</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">Example Org/CN</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">Root CA</span><br></span></code></pre></div></div>
<ul>
<li>The values that are displayed on each line within the database index include:</li>
<li>Status (V for valid, R for revoked, E for expired).</li>
<li>Expiry date in YYMMDDHHMMSSZ format.</li>
<li>Revocation date or empty if not revoked (in this example output, the field is empty).</li>
<li>Hexadecimal serial number.</li>
<li>File location or unknown, if not known.</li>
<li>Distinguished name.</li>
</ul>
<ol start=8>
<li>Next step is to create an intermediary CA that will be used to create all of
your server and client certificates. Create directory structure:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>mkdir</span><span class="token plain"> /root/ca-intermediary</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /root/ca-intermediary/</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>mkdir</span><span class="token plain"> certs db crl newcerts private</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>chmod</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>700</span><span class="token plain"> private</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>touch</span><span class="token plain"> db/index.txt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">openssl rand </span><span class="token parameter variable" style=color:#36acaa>-hex</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>16</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> db/serial</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1001</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>tee</span><span class="token plain">  db/crlnumber</span><br></span></code></pre></div></div>
<ol start=9>
<li>Intermediary config (<code>intermediary.conf</code>):</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">default</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">name                    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sub-ca</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">domain_suffix           </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> example.com</span><br></span><span class=token-line style=color:#393A34><span class="token plain">aia_url                 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> http://</span><span class="token variable" style=color:#36acaa>$name</span><span class="token builtin class-name">.</span><span class="token variable" style=color:#36acaa>$domain_suffix</span><span class="token plain">/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.crt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">crl_url                 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> http://</span><span class="token variable" style=color:#36acaa>$name</span><span class="token builtin class-name">.</span><span class="token variable" style=color:#36acaa>$domain_suffix</span><span class="token plain">/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.crl</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ocsp_url                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> http://ocsp.</span><span class="token variable" style=color:#36acaa>$name</span><span class="token builtin class-name">.</span><span class="token variable" style=color:#36acaa>$domain_suffix</span><span class="token plain">:9080</span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_ca              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ca_default</span><br></span><span class=token-line style=color:#393A34><span class="token plain">name_opt                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> utf8,esc_ctrl,multiline,lname,align</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ca_dn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">countryName             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AU"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationName        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Example Org"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">commonName              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Intermediary CA"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ca_default</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">home                    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">database                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/db/index.txt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">serial                  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/db/serial</span><br></span><span class=token-line style=color:#393A34><span class="token plain">crlnumber               </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/db/crlnumber</span><br></span><span class=token-line style=color:#393A34><span class="token plain">certificate             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.crt</span><br></span><span class=token-line style=color:#393A34><span class="token plain">private_key             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/private/</span><span class="token variable" style=color:#36acaa>$name</span><span class="token plain">.key</span><br></span><span class=token-line style=color:#393A34><span class="token plain">RANDFILE                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/private/random</span><br></span><span class=token-line style=color:#393A34><span class="token plain">new_certs_dir           </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$home</span><span class="token plain">/certs</span><br></span><span class=token-line style=color:#393A34><span class="token plain">unique_subject          </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> no</span><br></span><span class=token-line style=color:#393A34><span class="token plain">copy_extensions         </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> none</span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_days            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3650</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_crl_days        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>30</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_md              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sha256</span><br></span><span class=token-line style=color:#393A34><span class="token plain">policy                  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> policy_strict</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">policy_strict</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># The root CA should only sign intermediary certificates that match.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># See the POLICY FORMAT section of `man ca`.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">countryName             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> match</span><br></span><span class=token-line style=color:#393A34><span class="token plain">stateOrProvinceName     </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationName        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> match</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationalUnitName  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">commonName              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> supplied</span><br></span><span class=token-line style=color:#393A34><span class="token plain">emailAddress            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">policy_loose</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Allow the intermediary CA to sign a more diverse range of certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># See the POLICY FORMAT section of the `ca` manual page.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">countryName             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">stateOrProvinceName     </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">localityName            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationName        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">organizationalUnitName  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain">commonName              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> supplied</span><br></span><span class=token-line style=color:#393A34><span class="token plain">emailAddress            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> optional</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">req</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Standard Req options</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_bits            </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4096</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">encrypt_key             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>yes</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">default_md              </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sha256</span><br></span><span class=token-line style=color:#393A34><span class="token plain">utf8                    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>yes</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">string_mask             </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> utf8only</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prompt                  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> no</span><br></span><span class=token-line style=color:#393A34><span class="token plain">distinguished_name      </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ca_dn</span><br></span><span class=token-line style=color:#393A34><span class="token plain">req_extensions          </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> intermediary_ext</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ca_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for a the CA root (`man x509v3_config`).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints        </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical,CA:true</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage                </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical,keyCertSign,cRLSign</span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier    </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">intermediary_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for an intermediary CA.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># authorityKeyIdentifier = keyid:always,issuer</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, CA:true, pathlen:0</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, digitalSignature, cRLSign, keyCertSign</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">server_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for server certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CA:FALSE</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsCertType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> server</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsComment </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OpenSSL Generated Server Certificate"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">authorityKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> keyid,issuer:always</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, digitalSignature, keyEncipherment</span><br></span><span class=token-line style=color:#393A34><span class="token plain">extendedKeyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> serverAuth</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">client_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extensions for client certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CA:FALSE</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsCertType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> client, email</span><br></span><span class=token-line style=color:#393A34><span class="token plain">nsComment </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OpenSSL Generated Client Certificate"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">authorityKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> keyid,issuer</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, nonRepudiation, digitalSignature, keyEncipherment</span><br></span><span class=token-line style=color:#393A34><span class="token plain">extendedKeyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> clientAuth, emailProtection</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">crl_ext</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extension for CRLs.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>authorityKeyIdentifier</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">keyid:always</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ocsp</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># Extension for OCSP signing certificates.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">basicConstraints </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CA:FALSE</span><br></span><span class=token-line style=color:#393A34><span class="token plain">subjectKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token builtin class-name">hash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">authorityKeyIdentifier </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> keyid,issuer</span><br></span><span class=token-line style=color:#393A34><span class="token plain">keyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, digitalSignature</span><br></span><span class=token-line style=color:#393A34><span class="token plain">extendedKeyUsage </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> critical, OCSPSigning</span><br></span></code></pre></div></div>
<ol start=10>
<li>Create a CSR for the intermediary certificate:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl req </span><span class="token parameter variable" style=color:#36acaa>-new</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-config</span><span class="token plain"> intermediary.conf </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> sub-ca.csr </span><span class="token parameter variable" style=color:#36acaa>-keyout</span><span class="token plain"> private/sub-ca.key</span><br></span></code></pre></div></div>
<p>This certificate is also a signing certificate, so it is important to protect it
with a passphrase to help prevent its unauthorized use and maintain the security
of your infrastructure. Enter the passphrase when prompted.</p>
<ol start=11>
<li>Create a signed certificate for the intermediary CA. Copy the sub-ca.csr
that you generated in the previous step to the /root/ca directory on the system
where your root CA is hosted.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl ca </span><span class="token parameter variable" style=color:#36acaa>-config</span><span class="token plain"> ca-root.conf </span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> sub-ca.csr </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> newcerts/sub-ca.crt </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token parameter variable" style=color:#36acaa>-extensions</span><span class="token plain"> intermediary_ext</span><br></span></code></pre></div></div>
<ol start=12>
<li>Create a certificate chain file. Because no systems are aware of the root CA
certificate, you should create a certificate chain that includes the public
certificate for the root CA with the newly created intermediary CA certificate.
In this way, hosts only need a copy of the chained certificate to validate any
certificates that are issued by the intermediary CA. To create the certificate
chain, simply join the two public certificates by running the following command
on the root CA host:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>cat</span><span class="token plain"> root-ca.crt newcerts/sub-ca.crt </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> newcerts/chained-sub-ca.crt</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>chmod</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>444</span><span class="token plain"> newcerts/chained-sub-ca.crt</span><br></span></code></pre></div></div>
<p>Copy the <code>newcerts/sub-ca.crt</code> and <code>newcerts/chained-sub-ca.crt</code> certificate
back to the <code>/root/ca-intermediary/</code> directory on the intermediary CA host. You
can now use this certificate to process server and client CSRs and to generate
CRLs.</p>
<p>When you return a signed certificate for any given CSR, include the
<code>chained-sub-ca.crt</code> certificate so that it can be installed on the host where
the certificate will be used and distributed to any client that needs to
validate the signed certificate.</p>
<ol start=13>
<li>Process CSRs and Sign Certificates</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">openssl ca </span><span class="token parameter variable" style=color:#36acaa>-config</span><span class="token plain"> intermediary.conf </span><span class="token parameter variable" style=color:#36acaa>-extensions</span><span class="token plain"> server_ext </span><span class="token parameter variable" style=color:#36acaa>-days</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>375</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token parameter variable" style=color:#36acaa>-in</span><span class="token plain"> www.example.com.csr </span><span class="token parameter variable" style=color:#36acaa>-out</span><span class="token plain"> newcerts/www.example.com.crt</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=references>References<a href=#references class=hash-link aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href=https://pranabdas.github.io/drive/documents/linux-manuals/Oracle-linux--managing-TLS-certificates.pdf target=_blank rel="noopener noreferrer">Oracle manual: Managing Certificates and Public Key Infrastructure</a></li>
<li><a href=https://pranabdas.github.io/drive/documents/linux-manuals/red_hat_securing_networks.pdf target=_blank rel="noopener noreferrer">RedHat manual: Securing networks</a></li>
<li><a href=https://pranabdas.github.io/drive/documents/technical-articles/Securing-MongoDB-Cluster-with-TLS.pdf target=_blank rel="noopener noreferrer">Securing MongoDB Cluster with TLS</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/pranabdas/linux/blob/main/docs/tls-key-management.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/linux/network-security><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Network security</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/linux/storage-management><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Storage Management</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#generate-keys class="table-of-contents__link toc-highlight">Generate keys</a><li><a href=#certificate-signing-request class="table-of-contents__link toc-highlight">Certificate Signing Request</a><li><a href=#self-sign-certificates class="table-of-contents__link toc-highlight">Self-sign certificates</a><li><a href=#use-ca-to-sign class="table-of-contents__link toc-highlight">Use CA to sign</a><li><a href=#setup-root-ca class="table-of-contents__link toc-highlight">Setup root CA</a><li><a href=#references class="table-of-contents__link toc-highlight">References</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 Pranab Das. All rights reserved.</div></div></div></footer></div>